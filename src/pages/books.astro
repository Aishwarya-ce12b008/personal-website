---
import { getCollection } from "astro:content";
import BookTable from "@/components/book/BookTable.astro";
import ScrollHeader from "@/components/book/ScrollHeader.astro";
import type { Book } from "@/data/books";
import PageLayout from "@/layouts/Base.astro";

const bookEntries = await getCollection("book");
const books: Book[] = bookEntries.map((entry) => ({
	...entry.data,
	title: entry.data.title,
	// Content body contains description and recommendation combined
	description: entry.body?.split('\n')[0] || "",
	recommendation: entry.body?.split('\n').slice(2).join('\n') || "",
}));

const meta = {
	description: "A collection of books I've read, am reading, or hope to read soon.",
	title: "ðŸ“• My Bookshelf",
};
---

<PageLayout meta={meta} maxWidth="max-w-6xl" skipHeader={true}>
	<ScrollHeader />
	<div class="mb-8 flex flex-col gap-4">
		<div>
			<h1 class="title mb-4">My Bookshelf</h1>
			<p class="text-textColor/80 max-w-2xl">
				A curation of books that have shaped my thinking, stories that moved me, and what I'm
				looking forward to reading next.
			</p>
		</div>
	</div>

	<BookTable books={books} />
</PageLayout>
